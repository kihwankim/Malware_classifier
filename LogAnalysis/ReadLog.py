import csv
from datetime import time


def read_all():  # csv 파일을 모두 읽어 오는 코드
    """
    :return: read all of csv file's data and record them in list and return it
    """
    f = open('Logfile.CSV', 'r', encoding='utf-8')
    csv_reader = csv.reader(f)
    result = []
    index = 0
    for read_line in csv_reader:
        if index == 0:
            index += 1
            continue
        __store_in_array(read_line, result)
    f.close()

    return result


def print_all(list=None):  # 전부 출력
    """
    :param list: list which you have to print
    :return: it's void so no return data
    """
    if list is None:
        list = []
    for line in list:
        print(line)


def __store_in_array(line, list=None):  # 데이터 가공
    if list is None:
        list = []
    new_line = []
    index_of_each_line = 0
    for line_data in line:
        if index_of_each_line == 0:
            date = line[0].split()
            split_date = date[1].split(':')
            if date[0] == '오후':
                split_date[0] = int(split_date[0]) + 12

            second_and_micro = split_date[2].split('.')
            new_time_data = time(hour=int(split_date[0]), minute=int(split_date[1]), second=int(second_and_micro[0]),
                                 microsecond=int(int(second_and_micro[1]) / 100))

            new_line.append(new_time_data)
            index_of_each_line += 1
        else:
            new_line.append(line_data)
    list.append(new_line)


def pull_out_from_list(index, pull_out_data, list):  # 원하는 데이터만 뽑아는 것
    """
    :param index: 0 : 시간, 1 : fileName, 2 : PID 3 : regFunc 4: reg address, 5: function result, 6 : detail
    :param pull_out_data: pull out data which you want
    :param list: process monitor data
    :return: associated pull out data
    """
    result = []
    for list_data in list:
        if list_data[index] == pull_out_data:
            result.append(list_data)
    return result


"""
test code : 
list_of_servicesEXE_data = read_all()
print_all(list_of_servicesEXE_data)
pulled_out_data = pull_out_from_list(3, 'RegQueryValue', list_of_servicesEXE_data)
print_all(pulled_out_data)
"""
